# 質問リスト（要件確定用）

以下は`project.md`の方針をベースに、実装前に合意したい事項です。各項目にご回答ください（提案初期値があるものは括弧内に記載）。

## 1. スコープ/対象
- 1.1 対象ユーザの優先度はどれから始めますか？（研究者 > 安全性担当 > バイオインフォ）
- 1.2 初期リリースで必須のユースケースはどれですか？（UC1/UC2/UC3/UC4 すべて or 優先順）
- 1.3 企業ネットワーク/プロキシ配下での利用想定はありますか？（ある/ない）

- 1.1.A 対象は研究者です。
- 1.2.A UC1を優先します。
- 1.3.A ないです。しかし、企業ネットワーク/プロキシは以下で利用する場合を想定するとき、何を考慮しなければいけないかはドキュメントに残してください。

## 2. 入力/検証
- 2.1 一括入力の上限件数は？（提案: 50件/回）
- 2.2 入力フォーマット: 改行/カンマ/タブ混在を許容しますか？（許容）
- 2.3 無効IDやアイソフォーム表記（例: P04637-2）の扱い方は？（正規化→警告付きで受理）
- 2.4 ID重複や空行は自動除去で問題ないですか？（除去）

- 2.1.A 上限は100にしましょう。上限を大きくする際の問題や考慮点もドキュメントにまとめてください。
- 2.2.A 許容して問題が起きないのなら許容します。
- 2.3.A 無効IDは受け付けない。アイソフォーム表記は正規化するかどうか選択できるようにしたいですね。
- 2.4.A ID重複や空行は自動除去しましょう。


## 3. 種/オーソログ
- 3.1 既定の種はHuman(9606)で良いですか？（はい）
- 3.2 非Human入力時は「警告の上で続行」か「変換（オーソログ推定）」のどちらにしますか？（警告して続行）
- 3.3 種フィルタのUIはセレクト＋検索でよいですか？（はい）

- 3.1.A はい
- 3.2.A 非Human入力時は削除
- 3.3.A 種はHuman限定なのでフィルタの必要はないと思います。

## 4. STRING/PPI
- 4.1 `required_score`の初期値は？（提案: 700）
- 4.2 スライダー範囲は400–990で良いですか？（はい）
- 4.3 片方向/自己ループは除外しますか？（除外）
- 4.4 ノード/エッジの上限はどの程度にしますか？（提案: 3,000エッジでサブグラフ切替）
- 4.5 既定の中心性ハイライト件数Nは？（提案: 10件）

- 4.1.A 700にしてください
- 4.2.A はい
- 4.3.A 除外します
- 4.4.A 研究的に妥当な設定が良いです。これは私にはわからないので、調査を行い、根拠を示してせってしてください。
- 4.5.A 20件です

## 5. 経路/富化
- 5.1 富化の母集団は何にしますか？（提案: species内の全遺伝子）
- 5.2 多重検定はBenjamini–Hochbergで良いですか？（はい）
- 5.3 q値の閾値は？（提案: q < 0.05）
- 5.4 Reactome/KEGGの双方を既定ONにしますか？（はい）
- 5.5 結果の並び順はp値昇順で良いですか？（はい）

- 5.1.A species内の全遺伝子
- 5.2.A はい
- 5.3.A q < 0.05
- 5.4.A はい
- 5.5.A はい


## 6. 可視化/UI
- 6.1 可視化は`pyvis`を既定、Plotlyは補助で良いですか？（はい）
- 6.2 ノード色分けルール（中心性/入力/共通ノード）と凡例の文言はこの方針で良いですか？（はい/修正点があれば記入）
- 6.3 ツールチップに表示したい追加属性はありますか？（例: UniProt名、スコア、経路数）
- 6.4 検索（ノード名ジャンプ）機能は必須ですか？（提案: 必須）

- 6.1.A はい
- 6.2.A はい
- 6.3.A 経路数
- 6.4.A 必須

## 7. エクスポート
- 7.1 出力スキーマ（`nodes.csv`, `ppi_edges.csv`, `pathways.json`）で十分ですか？（はい/追加あり）
- 7.2 画像はPNGのみで良いですか？SVGも必要ですか？（提案: PNGのみ）
- 7.3 文字コードはUTF-8固定で問題ないですか？（はい）

- 7.1.A はい
- 7.2.A SVGも必要です。
- 7.3.A はい

## 8. キャッシュ/再現性
- 8.1 キャッシュTTLは24hで良いですか？（はい）
- 8.2 手動でキャッシュをクリアするUIが必要ですか？（提案: 必要）
- 8.3 レスポンスのJSONスナップショット保存を既定ONにしますか？（提案: OFF）

- 8.1.A はい
- 8.2.A 必要
- 8.3.A OFF

## 9. ログ/監視
- 9.1 ログ詳細度の既定はINFOで良いですか？（はい）
- 9.2 ユーザ入力（ID）のハッシュ化保存で問題ないですか？（はい）
- 9.3 簡易メトリクス（API呼数、命中率、遅延）の画面表示は必要ですか？（提案: 必要）

- 9.A すべて提案通り

## 10. パフォーマンス/SLO
- 10.1 P50/P95の目標値（2s/8s）で同意いただけますか？（はい）
- 10.2 測定は代表IDセットでの自動計測を行いますか？（提案: 行う）

-10.A すべて提案通り

## 11. エラー/フォールバック
- 11.1 レート制限時の最大リトライ回数は3回で良いですか？（はい）
- 11.2 失敗時のUI文言に禁則事項/出典注意を含めますか？（提案: 含める）
- 11.3 ID未解決時の候補提示はどの粒度まで行いますか？（提案: 近似一致＋アイソフォーム）

- 11.1A はい
- 11.2.A 含めない
- 11.3.A 近似一致


## 12. セキュリティ/ライセンス
- 12.1 KEGG結果はリンク参照のみ（再配布なし）方針で問題ないですか？（はい）
- 12.2 STRINGの出典表示位置/文言の指定はありますか？（なければ一般的表記）
- 12.3 入力履歴のローカル保存は既定OFFで良いですか？（はい）

-12.A すべて提案通り

## 13. 運用/開発体制
- 13.1 技術スタック（Python 3.11, FastAPI, Streamlit）は固定で良いですか？（はい）
- 13.2 最初の配布形態は`streamlit run`でのローカル実行で良いですか？（はい）
- 13.3 CI/テストの最小範囲はどこまで求めますか？（ユニット＋疎通）

- 13.A すべて提案通り

## 14. 受け入れ基準
- 14.1 既存AC1–AC4に加え、エラーハンドリング（AC5）を正式に含めますか？（はい）
- 14.2 具体的な代表IDのセットを指定してもらえますか？（例: 5–10件）

- 14.1.A いいえ
- 14.2.A P31946,P63104,P27348,P61981,Q04917,P62258

## 15. 将来拡張（参考）
- 15.1 他DB（GO/BioGRID/DrugBank等）連携の優先度は？
- 15.2 解析結果のセッション保存/共有（URL化）の要望はありますか？
- 15.3 Docker配布や社内サーバ設置の予定はありますか？

- 15.1.A わかりません。
- 15.2.A なし
- 15.3.A ないです

— 以上、ご回答を頂き次第、`docs/requirements_draft.md`を更新し、実装タスクへ落とし込みます。

